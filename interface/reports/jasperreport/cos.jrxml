<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 6.19.1.final using JasperReports Library version 6.19.1-867c00bf88cd4d784d404379d6c05e1b419e8a4c  -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="Austin COS 1-18-23" pageWidth="612" pageHeight="792" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="39db510b-b2ad-4906-8219-8bbdb95838b4">
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="production oemr"/>
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<parameter name="whereClause" class="java.lang.String"/>
	<parameter name="ImagePath" class="java.lang.String"/>
	<queryString>
		<![CDATA[SELECT
	cs.id as vh_oemr_uniquekey,
	cs.id,
replace(replace(concat(opc.pc_catname,' ',ope.pc_hometext),'\n',' '),'\r',' ') as appt_description,
replace(replace(concat(cs.case_description,' ',cs.comments),'\n',' '),'\r',' ') as case_description,
	cs.pid,
	pd.pubpid,
	case when cs.cash='1' then 'CASH' else concat(coalesce(ic1.name,''),(case when length(ic2.name)>0 then concat(', ',ic2.name) else '' end),(case when length(ic3.name)>0 then concat(', ',ic3.name) else '' end)) end as insurance,
	concat(coalesce(pd.`fname`,''),' ' ,coalescE(pd.`mname`,'') ,' ', coalesce(pd.`lname`,'')) as patient, 
	replace(pd.DOB,',','') as dob,DATE_FORMAT(ope.pc_eventDate,'%m-%d-%Y') as dos,
coalesce((select
	concat(opcc.pc_catname,', ',
	cast(concat(opee.pc_eventDate, ' ', opee.pc_startTime) as datetime),', ',concat(u.fname, ' ', u.mname, ' ', u.lname)
	) as description
from
	openemr_postcalendar_events opee
left join openemr_postcalendar_categories opcc on
	opcc.pc_catid = opee.pc_catid
left join users u on
	u.id = opee.pc_aid
where
	opee.pc_eventDate > ope.pc_eventDate
	and opee.pc_pid = cs.pid 
order by
	pc_eid desc limit 1),'N/A') as details,ope.pc_aid,ope.pc_catid,ope.pc_pid,
	(select balance from vh_form_case_balance where caseid=ope.pc_case) as balance,
	(select patientresp from vh_form_case_balance where caseid=ope.pc_case) as patientresp,ope.pc_case,
case when cs.ins_data_id1>0 then coalesce((select case when plan_status=1 then 'Yes' else 'No' end from coverage_eligibility where ins_id=cs.ins_data_id1 order by updated_at desc limit 1),'No') else '' end as Verified1,
case when cs.ins_data_id2>0 then coalesce((select case when plan_status=1 then 'Yes' else 'No' end from coverage_eligibility where ins_id=cs.ins_data_id2 order by updated_at desc limit 1),'No') else '' end as Verified2,
case when cs.ins_data_id3>0 then coalesce((select case when plan_status=1 then 'Yes' else 'No' end from coverage_eligibility where ins_id=cs.ins_data_id3 order by updated_at desc limit 1),'No') else '' end as Verified3,
concat(u.fname, ' ', u.lname) as DoctorName,case when cs.auth_req=0 then 'NO' else 'YES' end as Auth,
rehabplan(cs.id) as Rehab_plan,cs.injury_date,coalesce((SELECT
	concat(concat(left(u.fname,1),left(u.lname,1)),
	DATE_FORMAT(TIMESTAMP(pc_eventDate,
	pc_startTime),'%m/%y'))
from
	openemr_postcalendar_events ope,
	users u
where
	ope.pc_aid = u.id
	and ope.pc_apptstatus not in ('%', '?', 'x')
	and u.physician_type = 'general_physician'
	and ope.pc_case=cs.id limit 1),'N') as PCP,
	(select concat(u.fname,' ',u.lname)  from vh_pi_case_management_details vpcmd,users u where field_name ='case_manager' and case_id =cs.id and vpcmd.field_value=u.id) as referral_source,
	(select title  from list_options where list_id like 'refsource' and option_id =cs.referral_source) as RefSourceFromCase,
	rehabprogress(cs.id) as rehabprogress
FROM openemr_postcalendar_events ope left outer join openemr_postcalendar_categories opc on opc.pc_catid = ope.pc_catid
left outer join users u on u.id = ope.pc_aid, form_cases cs
LEFT JOIN patient_data AS pd ON
	pd.pid = cs.pid
LEFT JOIN patient_data AS gpd ON
	gpd.pid = cs.case_guarantor_pid
LEFT JOIN insurance_data AS insd1 ON
	insd1.id = cs.ins_data_id1
LEFT JOIN insurance_data AS insd2 ON
	insd2.id = cs.ins_data_id2
LEFT JOIN insurance_data AS insd3 ON
	insd3.id = cs.ins_data_id3
LEFT OUTER JOIN insurance_companies ic1 on 
	insd1.provider = ic1.id 
LEFT OUTER JOIN insurance_companies ic2 on 
	insd2.provider = ic2.id 
LEFT OUTER JOIN insurance_companies ic3 on 
	insd3.provider = ic3.id 	
LEFT JOIN patient_data AS inspd1 ON
	inspd1.pid = insd1.pid
LEFT JOIN patient_data AS inspd2 ON
	inspd2.pid = insd2.pid
LEFT JOIN patient_data AS inspd3 ON
	inspd3.pid = insd3.pid
$P!{whereClause}]]>
	</queryString>
	<field name="vh_oemr_uniquekey" class="java.lang.Long">
		<property name="com.jaspersoft.studio.field.name" value="id"/>
		<property name="com.jaspersoft.studio.field.label" value="vh_oemr_uniquekey"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="form_cases"/>
	</field>
	<field name="id" class="java.lang.Long">
		<property name="com.jaspersoft.studio.field.name" value="id"/>
		<property name="com.jaspersoft.studio.field.label" value="id"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="form_cases"/>
	</field>
	<field name="case_description" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="case_description"/>
		<property name="com.jaspersoft.studio.field.label" value="case_description"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="form_cases"/>
	</field>
	<field name="pid" class="java.lang.Long">
		<property name="com.jaspersoft.studio.field.name" value="pid"/>
		<property name="com.jaspersoft.studio.field.label" value="pid"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="form_cases"/>
	</field>
	<field name="pubpid" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="pubpid"/>
		<property name="com.jaspersoft.studio.field.label" value="pubpid"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="patient_data"/>
	</field>
	<field name="insurance" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="insurance"/>
		<property name="com.jaspersoft.studio.field.label" value="insurance"/>
	</field>
	<field name="patient" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="patient"/>
		<property name="com.jaspersoft.studio.field.label" value="patient"/>
	</field>
	<field name="dob" class="java.sql.Date">
		<property name="com.jaspersoft.studio.field.name" value="DOB"/>
		<property name="com.jaspersoft.studio.field.label" value="dob"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="patient_data"/>
	</field>
	<field name="dos" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="dos"/>
		<property name="com.jaspersoft.studio.field.label" value="dos"/>
	</field>
	<field name="details" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="details"/>
		<property name="com.jaspersoft.studio.field.label" value="details"/>
	</field>
	<field name="pc_aid" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="pc_aid"/>
		<property name="com.jaspersoft.studio.field.label" value="pc_aid"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="openemr_postcalendar_events"/>
	</field>
	<field name="pc_catid" class="java.lang.Integer">
		<property name="com.jaspersoft.studio.field.name" value="pc_catid"/>
		<property name="com.jaspersoft.studio.field.label" value="pc_catid"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="openemr_postcalendar_events"/>
	</field>
	<field name="pc_pid" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="pc_pid"/>
		<property name="com.jaspersoft.studio.field.label" value="pc_pid"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="openemr_postcalendar_events"/>
	</field>
	<field name="balance" class="java.lang.Double">
		<property name="com.jaspersoft.studio.field.name" value="balance"/>
		<property name="com.jaspersoft.studio.field.label" value="balance"/>
	</field>
	<field name="patientresp" class="java.lang.Double">
		<property name="com.jaspersoft.studio.field.name" value="patientresp"/>
		<property name="com.jaspersoft.studio.field.label" value="patientresp"/>
	</field>
	<field name="pc_case" class="java.lang.Long">
		<property name="com.jaspersoft.studio.field.name" value="pc_case"/>
		<property name="com.jaspersoft.studio.field.label" value="pc_case"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="openemr_postcalendar_events"/>
	</field>
	<field name="Verified1" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="Verified1"/>
		<property name="com.jaspersoft.studio.field.label" value="Verified1"/>
	</field>
	<field name="Verified2" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="Verified2"/>
		<property name="com.jaspersoft.studio.field.label" value="Verified2"/>
	</field>
	<field name="appt_description" class="java.lang.String"/>
	<field name="Verified3" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="Verified3"/>
		<property name="com.jaspersoft.studio.field.label" value="Verified3"/>
	</field>
	<field name="DoctorName" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="DoctorName"/>
		<property name="com.jaspersoft.studio.field.label" value="DoctorName"/>
	</field>
	<field name="Auth" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="Auth"/>
		<property name="com.jaspersoft.studio.field.label" value="Auth"/>
	</field>
	<field name="Rehab_plan" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="Rehab_plan"/>
		<property name="com.jaspersoft.studio.field.label" value="Rehab_plan"/>
	</field>
	<field name="injury_date" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="injury_date"/>
		<property name="com.jaspersoft.studio.field.label" value="injury_date"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="form_cases"/>
	</field>
	<field name="PCP" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="PCP"/>
		<property name="com.jaspersoft.studio.field.label" value="PCP"/>
	</field>
	<field name="referral_source" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="referral_source"/>
		<property name="com.jaspersoft.studio.field.label" value="referral_source"/>
	</field>
	<field name="RefSourceFromCase" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="RefSourceFromCase"/>
		<property name="com.jaspersoft.studio.field.label" value="RefSourceFromCase"/>
	</field>
	<field name="rehabprogress" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="rehabprogress"/>
		<property name="com.jaspersoft.studio.field.label" value="rehabprogress"/>
	</field>
	<background>
		<band splitType="Stretch"/>
	</background>
	<detail>
		<band height="752" splitType="Stretch">
			<image>
				<reportElement x="-10" y="-21" width="600" height="772" uuid="0aa41a82-2dfa-437d-b843-90718b9c2131"/>
				<imageExpression><![CDATA[$P{ImagePath}+"/cos.png"]]></imageExpression>
			</image>
			<textField>
				<reportElement x="51" y="46" width="149" height="14" uuid="8d7cb7d8-1b6c-43e7-adf2-1ea9f04d0356"/>
				<textElement verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{patient}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="234" y="46" width="70" height="14" uuid="0e91d0ad-e7b6-400a-8adc-1f3840aa7281"/>
				<textElement verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{pubpid}]]></textFieldExpression>
			</textField>
			<textField pattern="MM-dd-yyyy">
				<reportElement x="331" y="46" width="60" height="14" uuid="497e0148-614d-4612-b249-75de50af3e71"/>
				<textElement verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{dob}]]></textFieldExpression>
			</textField>
			<textField pattern="MM-dd-yyyy">
				<reportElement x="419" y="46" width="84" height="14" uuid="2c7dae5d-40b3-4af5-ab29-d9b168ad512c">
					<property name="com.jaspersoft.studio.element.name" value="Date of Service data from the encounter - primary data comes from the appointment table"/>
				</reportElement>
				<textElement verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{dos}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="60" y="104" width="388" height="12" uuid="92ecee74-5ea3-4b9a-a462-43c219d85221">
					<property name="com.jaspersoft.studio.element.name" value="Note that if it is CASH, just list Cash."/>
				</reportElement>
				<textElement verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{insurance}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="348" y="191" width="67" height="14" uuid="e6a5b9c5-02ac-4f9e-b0fc-689fcba59776">
					<property name="com.jaspersoft.studio.element.name" value="overall balance from idempiere for current case"/>
				</reportElement>
				<textElement verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{balance}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="474" y="192" width="72" height="12" uuid="c3af52e3-9645-4824-a0e3-f6e2fbcc47c1">
					<property name="com.jaspersoft.studio.element.name" value="patient responsibility from current case attached to appt"/>
				</reportElement>
				<textElement verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{patientresp}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="67" y="654" width="313" height="19" uuid="907007b1-10c2-4189-8763-5d8fc45201a4">
					<property name="com.jaspersoft.studio.element.name">
						<![CDATA[show next appt from next day onward.  If nothing, show "None"]]>
					</property>
				</reportElement>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{details}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="-10" y="14" width="600" height="29" uuid="f169cb8a-c1e5-493d-b1c0-455ab34679cc"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{DoctorName}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="44" y="72" width="498" height="24" uuid="05a35866-ed45-43c7-9f50-ecb8d042b485">
					<property name="com.jaspersoft.studio.element.name" value="Current Appointment Category concatenated with appointment notes seperated by a dash.  Remove end of lines and other space wasters."/>
				</reportElement>
				<textElement verticalAlignment="Top">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{appt_description}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="37" y="127" width="514" height="32" uuid="b16efa30-050e-4035-96bd-2bc7e9cc5a3f">
					<property name="com.jaspersoft.studio.element.name" value="Case Notes  Remove end of lines and other space wasters."/>
				</reportElement>
				<textElement verticalAlignment="Top">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{case_description}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="64" y="158" width="138" height="14" uuid="83ab600b-58a6-49aa-a45c-4f3c274b5a43">
					<property name="com.jaspersoft.studio.element.name" value="Exactly the same as the query in the case management report"/>
				</reportElement>
				<textElement verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{Rehab_plan}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="282" y="158" width="158" height="14" uuid="fbee855a-5843-4abc-b7a4-8fa10db49de0">
					<property name="com.jaspersoft.studio.element.name" value="Exactly the same as the query in the case management report"/>
				</reportElement>
				<textElement verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{rehabprogress}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="80" y="169" width="120" height="14" uuid="0a3cc7c4-66e7-47e1-a2b5-a1d4bc4eac04">
					<property name="com.jaspersoft.studio.element.name" value="As listed in the case management window"/>
				</reportElement>
				<textElement verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{RefSourceFromCase}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="232" y="169" width="120" height="14" uuid="f7e8b676-c778-4d1a-8012-c1c4c1c549e3">
					<property name="com.jaspersoft.studio.element.name" value="Injury/Illness Date listed in case window"/>
				</reportElement>
				<textElement verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{injury_date}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="470" y="158" width="62" height="14" uuid="efe21d85-20af-4c1d-8d12-1681e5a1f782">
					<property name="com.jaspersoft.studio.element.name" value="Exactly the same as the query in the case management report - list as it is under the Medical? Column"/>
				</reportElement>
				<textElement verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{PCP}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="486" y="169" width="60" height="14" uuid="bb958923-6d3d-4c1c-824c-f69f4bdc0d8c">
					<property name="com.jaspersoft.studio.element.name" value="Whether Authorization is required - is checked in case? - Yes or No"/>
				</reportElement>
				<textElement verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{Auth}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="485" y="104" width="67" height="12" uuid="aea9f5de-e329-488b-b37b-ea53982e55de">
					<property name="com.jaspersoft.studio.element.name" value="has the insurance been verified in OEMR with a green check? - yes or no"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{Verified1}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
</jasperReport>
